Options +FollowSymLinks

Options -Indexes
IndexIgnore * 

RewriteEngine On
RewriteBase /vcards/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L]


DirectoryIndex index.html  /index.php



RewriteRule ^.*/cards/(.*)$ /resources/download/$1 [L,R=301] 
RewriteRule ^.*/vcards/(.*)$ /resources/vcarddownload/$1 [L,R=301] 



<FilesMatch "\\.(js|css|html|htm|php|xml)$">
SetOutputFilter DEFLATE
</FilesMatch>
<IfModule mod_gzip.c>
#mod_gzip_on Yes
#mod_gzip_dechunk Yes
#mod_gzip_item_include file \.(html?|txt|css|js|php|pl)$
#mod_gzip_item_include handler ^cgi-script$
#mod_gzip_item_include mime ^text/.*
#mod_gzip_item_include mime ^application/x-javascript.*
#mod_gzip_item_exclude mime ^image/.*
#mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</IfModule>
 

<IfModule mod_php5.c>  
  php_value allow_url_fopen On
  php_value max_input_vars 4000
  php_value post_max_size '2000M'
  php_value memory_limit '60194M'
  php_value upload_max_filesize '128M'
  php_value max_input_nesting_level 64
  php_value max_file_uploads 200
  php_value max_input_time 0
  php_value max_execution_time 0    
</IfModule>


<IfModule mod_php5.c> 
	#php_value ServerSignature Off
</IfModule>

<IfModule mod_headers.c>
 #Header always unset Server
 #Header unset Server 
 #Header always unset X-Powered-By
 #Header unset X-Powered-By
 #Header unset X-CF-Powered-By
 #Header unset X-Mod-Pagespeed
 #Header unset X-Pingback
  
 #ServerSignature Off
 
 
 #Header unset Pragma
 #Header unset Last-Modified
 #Header unset Cache-Control

</IfModule>

<IfModule mod_headers.c>
 Header always unset Server
 Header unset Server 
 Header always unset X-Powered-By
 Header unset X-Powered-By
 Header unset X-CF-Powered-By
 Header unset X-Mod-Pagespeed
 Header unset X-Pingback
 ServerSignature Off
 Header unset Pragma
 Header unset Last-Modified
 Header unset Cache-Control
	
	Header edit Set-Cookie ^(.*)$ $1;HttpOnly;Secure;SameSite=strict
	  
	Header set X-XSS-Protection "1; mode=block"
	Header set X-Frame-Options "SAMEORIGIN"
	Header set X-Content-Type-Options "nosniff"
	Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains"
	# Header set Content-Security-Policy ...
	Header set Referrer-Policy "same-origin"
	Header set Feature-Policy "geolocation 'self'; vibrate 'none'"
	
	Header always append X-Frame-Options "SAMEORIGIN"
	

	# prevent mime based attacks
	Header set X-Content-Type-Options "nosniff"

	# Only allow JavaScript from the same domain to be run.
	# Don't allow inline JavaScript to run.
	Header set X-Content-Security-Policy "allow 'self';"
	
</IfModule>

# Prevent Script Injection
<IfModule mod_rewrite.c>
	 

    RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
	RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
	RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
	RewriteRule ^(.*)$ index.html [F,L] 
	
	
	
	
</IfModule>

# protect .htaccess
<Files ~ "^.*\.([Hh][Tt][Aa])">
	Order allow,deny
	Deny from all
	Satisfy all
</Files> 

# Deny access to error_log
<files error_log>
Order allow,deny
Deny from all
</files>

# Deny access to readme.html
<files readme.html>
Order allow,deny
Deny from all
</files>
# Deny access to readme.html
<files .well-known>
Order allow,deny
Deny from all
</files>
# Deny access to README
<files README>
Order allow,deny
Deny from all
</files>
 
<files icons>
Order allow,deny
Deny from all
</files> 
 
# Deny access to php.ini
<files php.ini>
Order allow,deny
Deny from all
</files> 
# Deny access to license.txt
<files license.txt>
Order allow,deny
Deny from all
</files>

# Blocks some XSS attacks
<IfModule mod_rewrite.c>
RewriteCond %{QUERY_STRING} (\|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
RewriteRule .* index.html [F,L]
 

</IfModule>
 